[.text-center]
== 1BRC with Dataframe-EC: Process
[.text-left]

[frame=none]
[grid=none]
[cols="55a,~a"]
|===
|
[source,java]
----
DataFrame aggregated = measurements
        .aggregateBy(
                Lists.immutable.of(
                    min("Temperature", "Min"),
                    avg2d("Temperature", "Mean"),
                    max("Temperature", "Max")),
                Lists.immutable.of("Station")
        )
        .sortBy(Lists.immutable.of("Station"));
----

|
==== after `aggregateBy`
[%autowidth]
[cols=",>,>,>"]
!===
!Station !Min !Mean !Max

! New York City ! -2.7 ! 18.56667 ! 34.1
! San Francisco ! -5.4 !     17.5 !   35
! Istanbul      !  5.9 ! 11.36667 !   15
! Tauranga      ! 17.4 !     17.4 ! 17.4
!===

==== after `sort`
[%autowidth]
[cols=",>,>,>"]
!===
!    Station    ! Min  !   Mean   ! Max

! Istanbul      !  5.9 ! 11.36667 !   15
! New York City ! -2.7 ! 18.56667 ! 34.1
! San Francisco ! -5.4 !     17.5 !   35
! Tauranga      ! 17.4 !     17.4 ! 17.4
!===

|===
